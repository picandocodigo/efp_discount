/* EFP Unofficial discount calculator */

var amountInput=document.getElementById("amount"),dtAmountInput=document.getElementById("dt-amount"),discounted=document.getElementById("discounted"),efp5={element:document.getElementById("efp5"),discount:5},efp10={element:document.getElementById("efp10"),discount:10},ambassador={element:document.getElementById("ambassador"),discount:5},tattoo={element:document.getElementById("tattoo"),discount:20},mylocal={element:document.getElementById("mylocal"),discount:2.5},doubled=document.getElementById("doubled"),discounts=[efp5,efp10,ambassador,tattoo,mylocal];function calculate_discounts(){(can_calculate_dt()||can_calculate_discount())&&(discounted.value=Number((discount_amount()+dt_discount_amount()).toFixed(2)))}function discount_amount(){if(!can_calculate_discount())return 0;refreshDouble();var t=parseFloat(amountInput.value);return discounts.forEach(function(e){1==e.element.checked&&(t=t*(100-e.discount)/100)}),t}function dt_discount_amount(){if(!can_calculate_dt())return 0;refreshDouble();var t=parseFloat(dtAmountInput.value);return discounts.forEach(function(e){1==e.element.checked&&(t=t*(100-e.discount)/100)}),1==tattoo.element.checked?t:.85*t}function can_calculate_dt(){return!(""==dtAmountInput.value||null==dtAmountInput.value)}function can_calculate_discount(){return!(""==amountInput.value||null==amountInput.value)}function refreshUI(){discounts.forEach(function(e){elem=e.element,1==elem.checked?elem.parentNode.parentNode.classList.add("checked"):elem.parentNode.parentNode.classList.remove("checked")}),1==tattoo.element.checked?(dtAmountInput.value="",dtAmountInput.disabled=!0,discounted.value=""):dtAmountInput.disabled=!1}function refreshDouble(){1==doubled.checked?(efp5.discount=10,efp10.discount=20,doubled.parentNode.parentNode.classList.add("checked")):(efp5.discount=5,efp10.discount=10,doubled.parentNode.parentNode.classList.remove("checked"))}efp5.element.addEventListener("change",function(){1==efp10.element.checked&&(efp10.element.checked=!1),refreshUI()}),efp10.element.addEventListener("change",function(){1==efp5.element.checked&&(efp5.element.checked=!1),refreshUI()}),tattoo.element.addEventListener("change",function(){refreshUI()}),ambassador.element.addEventListener("change",function(){refreshUI()}),doubled.addEventListener("change",function(){refreshUI()}),mylocal.element.addEventListener("change",function(){refreshUI()}),discounts.forEach(function(e){e.element.addEventListener("change",function(){calculate_discounts()})}),doubled.addEventListener("change",function(){calculate_discounts()}),amountInput.addEventListener("input",function(){calculate_discounts()}),dtAmountInput.addEventListener("input",function(){calculate_discounts()});